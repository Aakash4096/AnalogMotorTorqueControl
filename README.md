# Zine Project
## Stage 0:
Downloading application such as KiCAD for designing ,simulation and PCB development for the whole project
### Before going to project, the terms one should be familiar with

H-Bridge	A configuration of four MOSFETs (Q1–Q4) that allows current through a DC motor to flow in both directions. It’s called an “H-bridge” because the circuit looks like the letter H: the motor forms the crossbar, and the transistors form the legs.
Purpose	Used to control both direction and speed of a DC motor.
Operation Modes	- Forward: Q1 + Q4 ON (current one way)
- Reverse: Q2 + Q3 ON (current opposite way)
- Brake: Both high-side ON or both low-side ON
- Coast: All OFF
Control Method	Controlled via PWM (Pulse Width Modulation) to vary speed, and logic signals to change direction.


------------------------------------------------------

Half-Bridge	A circuit that controls one side (or “leg”) of an H-bridge — it has a high-side switch and a low-side switch.
Half-Bridge Driver IC	A chip that generates proper gate voltages to drive both MOSFETs (one high-side and one low-side) safely. Example: IR2104, IR2101, HIP4081.
Need for a Driver	- The high-side MOSFET’s gate needs a voltage higher than the supply (Vcc) to turn fully ON.
- A bootstrap capacitor provides this extra voltage.
- The driver ensures dead-time (short delay between switching) so both MOSFETs are not ON at the same time (which would cause a short).
Full H-Bridge with Drivers	Two half-bridge driver ICs together make a full H-bridge (one IC controls each motor terminal).


-----------------------------------------------------


High-Side Switch	The transistor (MOSFET) that connects the motor terminal to +Vcc (e.g., Q1, Q3). Must handle full supply voltage. Usually a P-channel MOSFET or an N-channel driven by a bootstrap circuit.
Low-Side Switch	The transistor that connects the motor terminal to GND (e.g., Q2, Q4). Driven directly from a logic gate or driver IC.
Challenge	Driving the high-side switch requires a voltage higher than Vcc, which is why driver ICs are essential.



-----------------------------------------------------------------


Definition	A digital control method where you switch the motor ON and OFF rapidly (hundreds or thousands of times per second). The average voltage seen by the motor determines speed.
Duty Cycle	The ratio of ON time to total period. Higher duty cycle → more average voltage → faster motor speed.
Frequency	Typical values: 5–20 kHz (high enough to avoid audible noise).
Implementation	Generated by a microcontroller (in your case, ATtiny13A) and fed to the driver IC inputs.



--------------------------------------------------------------------------


Bootstrap Capacitor (Cboot)	A capacitor charged to Vcc when the low-side switch is ON. When the high-side turns ON, this stored charge provides the extra gate voltage needed.
Bootstrap Diode (Dboot)	Allows the capacitor to charge when the low-side is ON, but blocks discharge.
Purpose	Enables an N-channel MOSFET to be used as a high-side transistor (better efficiency and lower Rds(on) than P-channel).


----------------------------------------------------------------------------


Dead-Time Control:-


Definition-	A short time delay between turning OFF one MOSFET and turning ON the opposite one in the same leg.
Why Needed-	Prevents both high-side and low-side switches from being ON simultaneously → avoids shoot-through current, which can destroy the transistors.
Implementation-	Usually built-in inside driver IC (like IR2104) or added by microcontroller timing logic.


---------------------------------------------------------------------------


Current Sensing and Torque Control-


Current Sense Resistor (Rshunt)	A small resistor (e.g., 0.1 Ω) placed in series with the motor to measure current.
Voltage Drop = I × R	The voltage across this resistor is proportional to the motor current → proportional to torque.
Analog Amplifier	Amplifies this small voltage for ADC measurement by the microcontroller.
Torque Control	By regulating motor current, you effectively control torque output (since torque ∝ current in DC motors).



--------------------------------------------------------------------------------



Protection Components-


Flyback Diodes (D1–D4)	Protect MOSFETs from voltage spikes due to motor’s inductive load when switching. Sometimes intrinsic in MOSFETs.
TVS Diode	Protects against sudden voltage surges from external power supply.
Fuse	Protects from short circuits or motor stall overcurrent.
Decoupling Capacitors (C1, C2, etc.)	Stabilize power lines and reduce switching noise.


-------------------------------------------------------------------------------------


Microcontroller (ATtiny13A)
Role	Explanation         
PWM Generation	Generates PWM signals for speed control.    
Direction Control	Sends logic signals to change motor direction.    
Current Measurement	Reads current sense signal for torque estimation.          
Feedback / Safety	Optionally can stop or limit current if torque too high.        

## Stage 1 – Circuit Design

### Power Stage – H-Bridge Design(Idea From Other's Project)

Purpose:

The H-Bridge is a power control circuit that lets current flow through a motor in both directions, so the motor can rotate clockwise or anticlockwise.
It also helps control speed and torque when used with PWM (Pulse Width Modulation) signals.


Started learning by watching how other deployed and operated the whole schematics and designing
From youtube :- https://www.youtube.com/watch?  v=4kDMF0SQ0Zg&list=PLJ0HErIq5D2zQIZq9s4L3cUzeMuB7d4Ho&index=2.   

Thus finally implemented it on my own.
![Schematics](https://github.com/Aakash4096/AnalogMotorTorqueControl/raw/main/assets/H_bridge_schematics.png)
![Template_PCB](https://github.com/Aakash4096/AnalogMotorTorqueControl/raw/main/assets/template_pcb.png)


#### moving back to our own project -


This project controls a 12 V DC motor using a full H-bridge configuration driven by two IR2104 half-bridge driver ICs.
Each half-bridge controls one side of the motor, allowing forward and reverse motion.
The ATtiny13A microcontroller generates PWM signals that modulate the motor speed, and a current sense resistor provides feedback proportional to motor torque.
The IR2104 drivers handle the high-side gate voltages using bootstrap capacitors, ensuring safe switching and dead-time to prevent shoot-through.
Protection components like flyback diodes, and decoupling capacitors ensure the circuit is robust against noise and overcurrent.



Searched and gone through specifications for my project 
Components used for this project  


-Motor specification=Light
12 V, 0.1 – 0.5 A
≤ 2 A
5–20 kHz

-Q_PMOS as p-MOSFET


-Q_NMOS_GDS as n-MOSFET


-Resistors


-SS34 as 40V 3A Schottky Diode, SMA


-IR2104 as Half-Bridge Driver, 600V, 210/360mA, PDIP-8/SOIC-8

Taking references from project developed in site:
https://www.pcbway.com/blog/technology/A_Standalone_Full_Bridge_DC_Motor_Driver_2c7c2086.html

Added PWM1 and PWM2 inputs from HALF-BRIDGE driver.

Thus my initial phase of project for power supply h bridge schematics looks like this :-

![Power_stage](https://github.com/Aakash4096/AnalogMotorTorqueControl/raw/main/assets/Power_stage_schematics.png)




![full_h_bridge_schematics](https://github.com/Aakash4096/AnalogMotorTorqueControl/raw/main/assets/Final_Schematics_Full_h-bridge.png)


By following this the above reference, i could finally draft my schematics as this which after testing if error occurs ,i will make minute changes and either edit this or will make a new subsection for it




![full_h_bridge_schematics](https://github.com/Aakash4096/AnalogMotorTorqueControl/raw/main/assets/Minor_Adjustment.png)





I have made some scahnges by introducing R_shunt for torque measurement in the motor below :- 



![full_h_bridge_schematics](https://github.com/Aakash4096/AnalogMotorTorqueControl/raw/main/assets/addedTorqueSensor.png)



Wanted to add amplifier to amplify current but will complicate the circuit more , first check it and if defection is not that much then will use amplifier as well 


### Some changes 

Noiticed that ,for quick switching of mosfet n type is more suitable than p type , hence i replaced earlier used p mosfet with n mosfet in high side as well and as i was giving the power to  gate using mosfet gate driver so i don't need any extra adjustment to the circuit.


## stage 2
Installed LTspice for simulation as i already know a few things of LTspice .



